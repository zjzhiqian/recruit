<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>JQuery ajaxfileupload文件上传</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="css/ajaxfileupload.css">
    <script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="js/ajaxfileupload.js"></script>

    <script type="text/javascript">

        //定时器对象
        var uploadProcessTimer = null;

        //获取文件上传进度
        function getFileUploadProcess() {
            $('#fileUploadProcess').html(123);
//            $.get('/upload/getFileProcessServlet', function (data) {
//                $('#fileUploadProcess').html(data);
//            });
        }

        function ajaxFileUpload() {
            //设置加载图标的显示
            $('#loading').show();
            uploadProcessTimer = window.setInterval(getFileUploadProcess, 20);

            $.ajaxFileUpload({
                url: '/api/v3/upload/userResume',
                secureuri: false,
                fileElementId: 'fileToUpload',
                dataType: 'json',
                data: {name: $('#name').val()},
                success: function (data, status) {
                    //清除定时器
                    if (uploadProcessTimer) {
                        window.clearInterval(uploadProcessTimer);
                    }
                    $('#loading').hide();
                    var message = data['message'];
                    var code = data['code'];
                    if (code != 200) {
                        $('#fileUploadProcess').html('0%');
                    }
                    if (message) {
                        alert(data.message);
                    }
                },
            });

            return false;
        }
    </script>
</head>
<body>
<h2>JQuery ajaxfileupload文件上传</h2>
<img id="loading" src="images/loading.gif" style="display:none;">
用户信息： <br/>
姓名：<input id="name" name="name" type="text"> <br/>
附件：<input id="fileToUpload" , name="uploadFile" type="file" class="input"> <br/>
<br><br>
<input type="button" onclick="return ajaxFileUpload();" value="上传"><br/>
上传进度：<label id="fileUploadProcess"></label>
</body>
</html>
